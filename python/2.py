# import urllib2
import re
import requests
import time
import random
import pandas as pd
from bs4 import BeautifulSoup
from openpyxl import Workbook
import xlrd
from ast import literal_eval
data=xlrd.open_workbook('aStock4_10.xlsx')#excle文件位置
sheet=data.sheets()[0] #读取第一个表
codes=sheet.col_values(1) #读取第一列
codes=codes[1:]
msci_ids=[]
company_names=[]
count = 0
for code in codes:
    cookies = {
        'COOKIE_SUPPORT': 'true',
        'EVICT_LIFERAY_LANGUAGE_ID': 'en_US',
        'NSC_JOdctk52djoenpmcm4jhopbeguyckd3': 'ffffffff09371edb45525d5f4f58455e445a4a423660',
        '__guid': '48416288.3291857846179853000.1589620250361.415',
        '_gid': 'GA1.2.939447867.1589620352',
        'msci_newsletter_floating_box': 'closed',
        'CS-OptIn': 'true',
        'GDPR-hide-banner': 'true',
        'Marketing-OptIn': 'true',
        '_hjid': '224773e3-cb5d-4082-b8a6-90c7a919e5bf',
        '_hjIncludedInSample': '1',
        'visitor_id36252': '425768159',
        'visitor_id36252-hash': 'b220c4d969c23d1d0a3e700c039229a725ce507dbb282b1b1528823a601dbca53d9cb8b178164e0fa45724261c4742e2c15d4d89',
        'monitor_count': '29',
        '_ga_1N2VH31REP': 'GS1.1.1589709514.8.1.1589709525.0',
        '_ga': 'GA1.2.13769966.1589620352',
        'LFR_SESSION_STATE_10163': '1589716731539',
        'JSESSIONID': 'CD061F7D95459380ACCC2D4780A61B90.jvmRoute-peu-cp-lapp0005',
        'ak_bmsc': '6AFA7BEBDA305D878181A68240E88A8617D16694413F00000227C15E35088B0D~plkWySL63CXHV6mULHFfn7Gfj/jXduFREEbTDuJjO3dMdqVdtVUKQ6W4FQJq5PqZAc0nn3M8cvbNM40X0u6T7wEAZMPOTOMNXmWrj3R/tjV8Z0yjp8GkCenkGJga+WEf8XK+Gr1bEqDaRpJIxdCWQ9YxMBPTJQHa3qNA3Zd8G74IpvmDzydRrMNtrTNP22Wtlfe+xtqr1L6q8MTtYdoNVBvKlpAukdcJtDur4IZ8l+Fxs=',
        'bm_sv': '02A8513B80608ACD344B3C49CA06E895~SwTEx1HCuXxQlyiGf5s/+bMnNICCggkK4sxV+0h5vW9lc7vS1iSzC8oly/f4PUNfnupciIihaEirxr2jmj0mGAk9y84JkgH0qiTs54FWDY8mRA6kIUMVRv0j/VlrgATmavI3C5ITRvsZ3eYZbjaV0w==',
    }

    headers = {
        'Connection': 'keep-alive',
        'Pragma': 'no-cache',
        'Cache-Control': 'no-cache',
        'Accept': '*/*',
        'DNT': '1',
        'X-Requested-With': 'XMLHttpRequest',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36',
        'Sec-Fetch-Site': 'same-origin',
        'Sec-Fetch-Mode': 'cors',
        'Referer': 'https://www.msci.com/esg-ratings/issuer/china-vanke-co-ltd/IID000000002142203',
        'Accept-Encoding': 'gzip, deflate, br',
        'Accept-Language': 'zh-CN,zh;q=0.9',
    }

    params = (
        ('p_p_id', 'esgratingsprofile'),
        ('p_p_lifecycle', '2'),
        ('p_p_state', 'normal'),
        ('p_p_mode', 'view'),
        ('p_p_resource_id', 'searchEsgRatingsProfiles'),
        ('p_p_cacheability', 'cacheLevelPage'),
        ('_esgratingsprofile_keywords',code),
    )
    response = requests.get('https://www.msci.com/esg-ratings', headers=headers, params=params, cookies=cookies)
    search_content=response.content
    search_content = str(search_content, encoding="utf-8")
    count = count+1
    if search_content == '[]':
        print('<%d> stock <%s> is not in msci' %(count,code))
        continue
    else:
        search_list = literal_eval(search_content)
        msci_id = search_list[0]['url']
        company_name = search_list[0]['encodedTitle']
        print('<%d> stock <%s> get msci title<%s> url <%s>' %(count,code,company_name, msci_id))
        msci_ids.append(msci_id)
        company_names.append(company_name)
print(msci_ids)
print(company_names)
count_msci=0
msci2excel=[]
# msci_ids = ['IID000000002771175', 'IID000000002722756', 'IID000000002720056', 'IID000000002732910', 'IID000000002729154', 'IID000000002816435', 'IID000000002679659', 'IID000000002801382', 'IID000000002649797', 'IID000000002812381', 'IID000000002771784', 'IID000000002735234', 'IID000000002800592', 'IID000000002804682', 'IID000000002703269', 'IID000000002726114', 'IID000000002684903', 'IID000000002839138', 'IID000000002774076', 'IID000000002649145', 'IID000000002712904', 'IID000000002124373', 'IID000000002261199', 'IID000000002398363', 'IID000000002163715', 'IID000000002255875', 'IID000000002572430', 'IID000000002412224', 'IID000000002767946', 'IID000000002196598', 'IID000000002161748', 'IID000000002605772', 'IID000000002624594', 'IID000000002190469', 'IID000000002149341', 'IID000000002452752', 'IID000000002261936', 'IID000000002163601', 'IID000000002277056', 'IID000000002574529', 'IID000000002125581', 'IID000000002132855', 'IID000000002263151', 'IID000000002246643', 'IID000000002124563', 'IID000000002161746', 'IID000000002609893', 'IID000000002260646', 'IID000000002356416', 'IID000000002183388', 'IID000000002260567', 'IID000000002617784', 'IID000000002403401', 'IID000000002140939', 'IID000000002161817', 'IID000000002451683', 'IID000000002151735', 'IID000000002151647', 'IID000000002149396', 'IID000000002260131', 'IID000000002243793', 'IID000000002251948', 'IID000000002634749', 'IID000000002256341', 'IID000000002149105', 'IID000000002133612', 'IID000000002640017', 'IID000000002676689', 'IID000000002264375', 'IID000000002617969', 'IID000000002636196', 'IID000000002262238', 'IID000000002679662', 'IID000000002609900', 'IID000000002237413', 'IID000000002398298', 'IID000000002161857', 'IID000000002159116', 'IID000000002126716', 'IID000000002747189', 'IID000000002840660', 'IID000000002573869', 'IID000000002629930', 'IID000000002186756', 'IID000000002602309', 'IID000000002141621', 'IID000000002718252', 'IID000000002599378', 'IID000000002641884', 'IID000000002142277', 'IID000000002593334', 'IID000000002253926', 'IID000000002602582', 'IID000000002685316', 'IID000000002135017', 'IID000000002261423', 'IID000000002261753', 'IID000000002271942', 'IID000000002260545', 'IID000000002150754', 'IID000000002151770', 'IID000000002161862', 'IID000000002134988', 'IID000000002151755', 'IID000000002189825', 'IID000000002151645', 'IID000000002124384', 'IID000000002143264', 'IID000000002143262', 'IID000000002134965', 'IID000000002151747', 'IID000000002143230', 'IID000000002183363', 'IID000000002157551', 'IID000000002134999', 'IID000000002167196', 'IID000000002134923', 'IID000000002151673', 'IID000000002190074', 'IID000000002187065', 'IID000000002151762', 'IID000000002183343', 'IID000000002169693', 'IID000000002143171', 'IID000000002180579', 'IID000000002143242', 'IID000000002190445', 'IID000000002143157', 'IID000000002161769', 'IID000000002142157', 'IID000000002183350', 'IID000000002134669', 'IID000000002183375', 'IID000000002183365', 'IID000000002134938', 'IID000000002182372', 'IID000000002126726', 'IID000000002187534', 'IID000000002169147', 'IID000000002187727', 'IID000000002140802', 'IID000000002151692', 'IID000000002186844', 'IID000000002168898', 'IID000000002157474', 'IID000000002126627', 'IID000000002189916', 'IID000000002183451', 'IID000000002183294', 'IID000000002161832', 'IID000000002143133', 'IID000000002161858', 'IID000000002126626', 'IID000000002151652', 'IID000000002173216', 'IID000000002151651', 'IID000000002143123', 'IID000000002134483', 'IID000000002134484', 'IID000000002190454', 'IID000000002171909', 'IID000000002133661', 'IID000000002125348', 'IID000000002141830', 'IID000000002187044', 'IID000000002190411', 'IID000000002141863', 'IID000000002125293', 'IID000000002141796', 'IID000000002133613', 'IID000000002148764', 'IID000000002171918', 'IID000000002261756', 'IID000000002171913', 'IID000000002141102', 'IID000000002163603', 'IID000000002132579', 'IID000000002183338', 'IID000000002138326', 'IID000000002146666', 'IID000000002163600', 'IID000000002155119', 'IID000000002135147', 'IID000000002130140', 'IID000000002146709', 'IID000000002138274', 'IID000000002189937', 'IID000000002183310', 'IID000000002138232', 'IID000000002155025', 'IID000000002183330', 'IID000000002190075', 'IID000000002130145', 'IID000000002146713', 'IID000000002159383', 'IID000000002130084', 'IID000000002189911', 'IID000000002125606', 'IID000000002161879', 'IID000000002124846', 'IID000000002183909', 'IID000000002154635', 'IID000000002185672', 'IID000000002141798', 'IID000000002161789', 'IID000000002146677', 'IID000000002141534', 'IID000000002130102', 'IID000000002160628', 'IID000000002138271', 'IID000000002146656', 'IID000000002168811', 'IID000000002161826', 'IID000000002130092', 'IID000000002142010', 'IID000000002161878', 'IID000000002124383', 'IID000000002159193', 'IID000000002155067', 'IID000000002133861', 'IID000000002143108', 'IID000000002130083', 'IID000000002146650', 'IID000000002921390', 'IID000000002841129', 'IID000000002816149', 'IID000000002812293', 'IID000000002801040', 'IID000000002796560', 'IID000000002795926', 'IID000000002776676', 'IID000000002770486', 'IID000000002571225', 'IID000000002839757', 'IID000000002731568', 'IID000000002726113', 'IID000000002720077', 'IID000000002715557', 'IID000000002684688', 'IID000000002684696', 'IID000000002650128', 'IID000000002641891', 'IID000000002639736', 'IID000000002634670', 'IID000000002625006', 'IID000000002624210', 'IID000000002616048', 'IID000000002605771', 'IID000000002605031', 'IID000000002603059', 'IID000000002602732', 'IID000000002599383', 'IID000000002588542', 'IID000000002588404', 'IID000000002586318', 'IID000000002573115', 'IID000000002453960', 'IID000000002453499', 'IID000000002453496', 'IID000000002453495', 'IID000000002453494', 'IID000000002453035', 'IID000000002254203', 'IID000000002629119', 'IID000000002778201', 'IID000000002772310', 'IID000000002735218', 'IID000000002720063', 'IID000000002684685', 'IID000000002649144', 'IID000000002261678', 'IID000000002629178', 'IID000000002623968', 'IID000000002623025', 'IID000000002158849', 'IID000000002619053', 'IID000000002615263', 'IID000000002612798', 'IID000000002611317', 'IID000000002611311', 'IID000000002603939', 'IID000000002604376', 'IID000000002603628', 'IID000000002259596', 'IID000000002602232', 'IID000000002598727', 'IID000000002597992', 'IID000000002597984', 'IID000000002597216', 'IID000000002596522', 'IID000000002596120', 'IID000000002593027', 'IID000000002591988', 'IID000000002591999', 'IID000000002591548', 'IID000000002591554', 'IID000000002591063', 'IID000000002590576', 'IID000000002589757', 'IID000000002587671', 'IID000000002587602', 'IID000000002587607', 'IID000000002172215', 'IID000000002586256', 'IID000000002586252', 'IID000000002386701', 'IID000000002575391', 'IID000000002575378', 'IID000000002574532', 'IID000000002570919', 'IID000000002569362', 'IID000000002451437', 'IID000000002420752', 'IID000000002359304', 'IID000000002355300', 'IID000000002289792', 'IID000000002200869', 'IID000000002203466', 'IID000000002197328', 'IID000000002196596', 'IID000000002183303', 'IID000000002189936', 'IID000000002183337', 'IID000000002190459', 'IID000000002161727', 'IID000000002131987', 'IID000000002140123', 'IID000000002148614', 'IID000000002131977', 'IID000000002181522', 'IID000000002159133', 'IID000000002186859', 'IID000000002171908', 'IID000000002177380', 'IID000000002182672', 'IID000000002189945', 'IID000000002140098', 'IID000000002185422', 'IID000000002183289', 'IID000000002171887', 'IID000000002159374', 'IID000000002190433', 'IID000000002186185', 'IID000000002171903', 'IID000000002148569', 'IID000000002190438', 'IID000000002168676', 'IID000000002148555', 'IID000000002131928', 'IID000000002190440', 'IID000000002169675', 'IID000000002131925', 'IID000000002751338', 'IID000000002182659', 'IID000000002131923', 'IID000000002167064', 'IID000000002146900', 'IID000000002170748', 'IID000000002182912', 'IID000000002169670', 'IID000000002163599', 'IID000000002131906', 'IID000000002187533', 'IID000000002169743', 'IID000000002149730', 'IID000000002169694', 'IID000000002168953', 'IID000000002148515', 'IID000000002159382', 'IID000000002189833', 'IID000000002183307', 'IID000000002131879', 'IID000000002148505', 'IID000000002147125', 'IID000000002161539', 'IID000000002140015', 'IID000000002190058', 'IID000000002189908', 'IID000000002131864', 'IID000000002131863', 'IID000000002167067', 'IID000000002150013', 'IID000000002140154', 'IID000000002158773', 'IID000000002148644', 'IID000000002169828', 'IID000000002132004', 'IID000000002161357', 'IID000000002177602', 'IID000000002148632', 'IID000000002161534', 'IID000000002168285', 'IID000000002187043', 'IID000000002178994', 'IID000000002169685', 'IID000000002142017', 'IID000000002171927', 'IID000000002159837', 'IID000000002157468', 'IID000000002189393', 'IID000000002174178', 'IID000000002140096', 'IID000000002190202', 'IID000000002139649', 'IID000000002189970', 'IID000000002125917', 'IID000000002148565', 'IID000000002131931', 'IID000000002166417', 'IID000000002186184', 'IID000000002189390', 'IID000000002261512', 'IID000000002150747', 'IID000000002190185', 'IID000000002183440', 'IID000000002183465', 'IID000000002161796', 'IID000000002190270', 'IID000000002133895', 'IID000000002183472', 'IID000000002150503', 'IID000000002148543', 'IID000000002148546', 'IID000000002147120', 'IID000000002138738', 'IID000000002151673']
# company_names = ['gigadevice-semiconductor-beijing-inc','yifeng-pharmacy-chain-co-ltd']
for index,msci_id in enumerate(msci_ids):
    cookies = {
        'COOKIE_SUPPORT': 'true',
        'EVICT_LIFERAY_LANGUAGE_ID': 'en_US',
        'NSC_JOdctk52djoenpmcm4jhopbeguyckd3': 'ffffffff09371edb45525d5f4f58455e445a4a423660',
        '__guid': '48416288.3291857846179853000.1589620250361.415',
        '_gid': 'GA1.2.939447867.1589620352',
        'msci_newsletter_floating_box': 'closed',
        'CS-OptIn': 'true',
        'GDPR-hide-banner': 'true',
        'Marketing-OptIn': 'true',
        '_hjid': '224773e3-cb5d-4082-b8a6-90c7a919e5bf',
        '_hjIncludedInSample': '1',
        'visitor_id36252': '425768159',
        'visitor_id36252-hash': 'b220c4d969c23d1d0a3e700c039229a725ce507dbb282b1b1528823a601dbca53d9cb8b178164e0fa45724261c4742e2c15d4d89',
        'JSESSIONID': 'BD08CDA173DFBCA2D70EBDE06D955BD8.jvmRoute-peu-cp-lapp0005',
        'ak_bmsc': '5913A8C3DAE49E2DFEB48DA4FEAF3A111737DE2F94420000C5A5C05E8958EF42~pldVLx8szPAAxRLUwHwx3yzDhjEeVql3bAkwsBNKpokf/103Le1Gmra+mI2WtojihL34hih9mGLgU4AucbGXKKp8b4nXFcP142jVTd4EA6E2HURkMHuSwLHTkt5GW0UNBiT1dH+GQ3ccbdoQ4zAMLfWbtJSIwm9I4R3jgGS3t8NSbmZ13hvDy2nfRTXutnxBJ1xNn2sfxINibWtIMBO/mGuKnRitLV59DGD0mH7sYaMcCBsQ/nm0xibaRhf6Dh99qx',
        '_gat_UA-397044-15': '1',
        'LFR_SESSION_STATE_10163': '1589685224483',
        'bm_sv': '5F3A51AB27CF23E06679E067B0F7D66E~sm3nSpbouNQa14Hp1kEHBt/23oUAs5d6sV3pmPt+bmJT8D1Cue4yUSsk6+iLO0xBxVbcsmhjSPyqGy3C/c+nCUGPojvqcgFKoeE6FITe3newjTZnlRTrsz1qJI2bnkfgn/8Rr2rX9aTd75vEs4IbsWNRuYo+UEJCuKAaXoA7Z/8=',
        'monitor_count': '26',
        '_ga_1N2VH31REP': 'GS1.1.1589683656.4.1.1589685240.0',
        '_ga': 'GA1.2.13769966.1589620352',
    }

    headers = {
        'Connection': 'keep-alive',
        'Pragma': 'no-cache',
        'Cache-Control': 'no-cache',
        'Accept': '*/*',
        'DNT': '1',
        'X-Requested-With': 'XMLHttpRequest',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36',
        'Sec-Fetch-Site': 'same-origin',
        'Sec-Fetch-Mode': 'cors',
        'Referer': 'https://www.msci.com/esg-ratings/issuer/'+company_names[index]+'/'+msci_id,
        'Accept-Encoding': 'gzip, deflate, br',
        'Accept-Language': 'zh-CN,zh;q=0.9',
    }

    params = (
        ('p_p_id', 'esgratingsprofile'),
        ('p_p_lifecycle', '2'),
        ('p_p_state', 'normal'),
        ('p_p_mode', 'view'),
        ('p_p_resource_id', 'showEsgRatingsProfile'),
        ('p_p_cacheability', 'cacheLevelPage'),
        ('_esgratingsprofile_issuerId', msci_id),
    )
    html = requests.get('https://www.msci.com/esg-ratings', headers=headers, params=params, cookies=cookies)
    # content='''
    # b'\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t<div id="_esgratingsprofile_esg-ratings-profile" class="esg-ratings-profile container-fluid container-fluid-max-xl">\n\t\t\n<div id="_esgratingsprofile_esg-ratings-profile-header" class="esg-ratings-profile-header">\n\t<div class="esg-ratings-profile-header-coredata">\n\t\t<div class="header-company-title">\n\t\t\tINDUSTRIAL BANK CO.,LTD.\n\t\t</div>\n\t\t<div class="header-company-ticker">\n\t\t\t(601166)\n\t\t</div>\n\t\t<div class="header-company-info">\n\t\t\t<div class="header-esg-industry">\n\t\t\t\t<b>Industry: </b> Banks\n\t\t\t</div>\n\t\t\t<div class="header-country">\n\t\t\t\t<b>Country: </b> China\n\t\t\t</div>\t\n\t\t</div>\n\t</div>\n\t\n\t<div class="esg-ratings-profile-header-ratingdata">\n\t\t<hr class="esgratings-profile-header-border-yellow">\n\t\t<div class="ratingdata-container">\n\t\t\t<div class="ratingdata-msci">\n\t\t\t\tMSCI\n\t\t\t\t<div class="ratingdata-esgratings">\n\t\t\t\t\tESG RATINGS\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ratingdata-outercircle esgratings-profile-header-yellow">\n\t\t\t\t<div class="ratingdata-company-rating esg-rating-circle-a"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class="ratingdata-table">\n\t\t    <div class="ratingdata-row">\n\t\t    \t\n\t\t\t        <div class="ratingdata-cell">\n\t\t\t        \t<div class="ratingdata-cell-content esg-rating-cell-grey-ccc">\n\t\t\t        \t</div>\n\t\t        \t</div>\n\t\t        \t\n\t\t\t        <div class="ratingdata-cell">\n\t\t\t        \t<div class="ratingdata-cell-content esg-rating-cell-grey-b">\n\t\t\t        \t</div>\n\t\t        \t</div>\n\t\t        \t\n\t\t\t        <div class="ratingdata-cell">\n\t\t\t        \t<div class="ratingdata-cell-content esg-rating-cell-grey-bb">\n\t\t\t        \t</div>\n\t\t        \t</div>\n\t\t        \t\n\t\t\t        <div class="ratingdata-cell">\n\t\t\t        \t<div class="ratingdata-cell-content esg-rating-cell-grey-bbb">\n\t\t\t        \t</div>\n\t\t        \t</div>\n\t\t        \t\n\t\t\t        <div class="ratingdata-cell esgratings-profile-header-yellow">\n\t\t\t        \t<div class="ratingdata-cell-content esg-rating-cell-white-a">\n\t\t\t        \t</div>\n\t\t        \t</div>\n\t\t        \t\n\t\t\t        <div class="ratingdata-cell">\n\t\t\t        \t<div class="ratingdata-cell-content esg-rating-cell-grey-aa">\n\t\t\t        \t</div>\n\t\t        \t</div>\n\t\t        \t\n\t\t\t        <div class="ratingdata-cell">\n\t\t\t        \t<div class="ratingdata-cell-content esg-rating-cell-grey-aaa">\n\t\t\t        \t</div>\n\t\t        \t</div>\n\t\t        \t\n\t\t    </div>\n\t\t</div>\n\t</div>\n</div>\n\n<script>\n\nfunction lowerFontSize(diff){\n\tvar title = $(\'.header-company-title\');\n\tvar lines = title.height() / parseInt(title.css(\'line-height\'), 10);\n\tvar fontSize = parseInt($(\'.header-company-title\').css(\'font-size\'));\n\t\n\t\n\tif(lines > 4){\n\t\tfontSize = fontSize - 2 + "px";\n\t\t$(\'.header-company-title\').css(\'font-size\', fontSize);\n\t\tlowerFontSize(diff-2);\n\t}\n\telse if(diff != 0){\n\t\tvar tickerFontSize = Math.min(fontSize - 2, 20) + "px";\n\t\tvar tickerLineHeight = tickerFontSize * 1.25 + "px";\n\t\tvar lineHeight = fontSize * 1.25 + "px";\n\t\t$(\'.header-company-title\').css(\'line-height\', lineHeight);\n\t\t$(\'.header-company-ticker\').css(\'line-height\', tickerLineHeight);\n\t\t$(\'.header-company-ticker\').css(\'font-size\', tickerFontSize);\n\t}\n}\n\n$(document).ready(function() {\n\tlowerFontSize(0);\n});\n\n</script>\n\n\t\t\n\n<hr>\n<div id="_esgratingsprofile_esg-ratings-profile-graphs"\n\tclass="esg-ratings-profile-graphs row">\n\t\t\n\t<div class="esg-rating-paragraph esg-rating-paragraph-hist col-lg-6">\n\t\t\n\t\t\t\n\t\t\t\tIndustrial Bank was upgraded in November, 2019.\n\t\t\t\n\t\t\t\n\t</div>\n\n\t<div class="esg-rating-subtitle-container esg-rating-subtitle-container-hist col-lg-6">\n\t\t<div class="esg-rating-subtitle">\n\t\t\t<h5>\n\t\t\t\tESG Rating history\n\t\t\t</h5>\n\t\t</div>\n\t\t<hr>\n        <div>\n            MSCI ESG Rating history data over the last five years or since records began.\n        </div>\n\t</div>\n\t\n\t<div id="_esgratingsprofile_esg-rating-history"\n\t\tclass="esg-ratings-profile-graph esg-ratings-profile-graph-hist col-lg-6"></div>\n\n\n\t<div class="esg-rating-paragraph esg-rating-paragraph-distr col-lg-6">\n\t\t\n\t\t\t\n\t\t\t\tIndustrial Bank is <span class="average-letters">Average</span> among 212 companies in the <b>banks industry</b>.\n\t\t\t\n\t\t\t\n\t</div>\n\t\n\t<div class="esg-rating-subtitle-container esg-rating-subtitle-container-distr col-lg-6">\n\t\t<div class="esg-rating-subtitle">\n\t\t\t<h5>\n\t\t\t\tESG Rating distribution\n\t\t\t</h5>\n\t\t</div>\n\t\t<hr>\n\t\t<div>\n\t\t\tUniverse: MSCI ACWI Index constituents banks, n=212.\n\t\t</div>\n\t</div>\n\t\t\n\t<div id="_esgratingsprofile_esg-rating-distribution"\n\t\tclass="esg-ratings-profile-graph esg-ratings-profile-graph-distr col-lg-6"></div>\n\n</div>\n<hr>\n<script type="text/javascript">\nvar msciDark = "#002036";\nvar msciWhite = "#FFFFFF";\nvar msciDarkGrey = "#666666";\nvar robotoRegular = "\'Roboto Regular\', sans-serif;";\nvar robotoBlack = "\'Roboto Black\', sans-serif;";\nvar opacity = 0.3;\nvar msciFontSizeH4 = "24px;"\nvar msciFontSizeLarge = "16px;"\nvar msciFontSizeMedium = "14px;"\nvar msciFontSizeSmall = "12px;"\nvar msciFontSizeSmaller = "10px;"\nvar msciFontSizeSmallest = "8px;"\nvar phone = 320;\nvar tablet = 768;\nvar desktop = 992;\n\n$(document).ready(function() {\n\tvar chartData = {};\n\tvar ratingTypes = [];\n\tvar ratingTypesValueAndColorMapping = {};\n\t\t\n\t\n\t\tratingTypes.push("CCC");\n\t\tratingTypesValueAndColorMapping["CCC"] = {\'value\': 0, \'color\': \'#CF333B\'};\n\t\t\n\t\tratingTypes.push("B");\n\t\tratingTypesValueAndColorMapping["B"] = {\'value\': 1, \'color\': \'#CF333B\'};\n\t\t\n\t\tratingTypes.push("BB");\n\t\tratingTypesValueAndColorMapping["BB"] = {\'value\': 2, \'color\': \'#FFB500\'};\n\t\t\n\t\tratingTypes.push("BBB");\n\t\tratingTypesValueAndColorMapping["BBB"] = {\'value\': 3, \'color\': \'#FFB500\'};\n\t\t\n\t\tratingTypes.push("A");\n\t\tratingTypesValueAndColorMapping["A"] = {\'value\': 4, \'color\': \'#FFB500\'};\n\t\t\n\t\tratingTypes.push("AA");\n\t\tratingTypesValueAndColorMapping["AA"] = {\'value\': 5, \'color\': \'#007567\'};\n\t\t\n\t\tratingTypes.push("AAA");\n\t\tratingTypesValueAndColorMapping["AAA"] = {\'value\': 6, \'color\': \'#007567\'};\n\t\t\n\n\tchartData.esgRatingHistory = {};\n\tchartData.esgRatingHistory.dates = [];\n\tchartData.esgRatingHistory.ratings = [];\n\tchartData.esgRatingDistribution = {};\n\tchartData.esgRatingDistribution.distribution = [];\n\n\t \n\t\tchartData.esgRatingHistory.dates.push(\'Apr-18\');\n\t\tvar rating = \'BBB\';\n\t\tvar map = {\n\t\t\t\ty: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tx: 0,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: ratingTypesValueAndColorMapping[rating].color\n\t\t}\n\t\tchartData.esgRatingHistory.ratings.push(map);\n\t\t \n\t\tchartData.esgRatingHistory.dates.push(\'Sep-18\');\n\t\tvar rating = \'BBB\';\n\t\tvar map = {\n\t\t\t\ty: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tx: 1,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: ratingTypesValueAndColorMapping[rating].color\n\t\t}\n\t\tchartData.esgRatingHistory.ratings.push(map);\n\t\t \n\t\tchartData.esgRatingHistory.dates.push(\'Nov-19\');\n\t\tvar rating = \'A\';\n\t\tvar map = {\n\t\t\t\ty: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tx: 2,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: ratingTypesValueAndColorMapping[rating].color\n\t\t}\n\t\tchartData.esgRatingHistory.ratings.push(map);\n\t\t \n\t\n\tvar esgRatingHistoryChart = Highcharts.chart(\'_esgratingsprofile_esg-rating-history\', {\n\t\tlegend: false,\n\t\tcredits: false,\n\t\ttitle: undefined,\n\t\tseries: [\n\t\t\t{\n\t\t\t\tcolor: msciDark,\n\t\t\t\tdata: chartData.esgRatingHistory.ratings,\n\t\t\t\tlineWidth: 2\n\t\t\t}\n\t\t],\n\t\tchart: {\n\t\t\ttype: "line",\n\t\t\theight: 250,\n\t\t\tstyle: {\n\t\t\t\t"fontFamily": robotoRegular,\n\t\t\t\t"fontSize": msciFontSizeSmall,\n\t\t\t\t"color": msciDark\n\t\t\t}\n\t\t},\n\t\tyAxis: {\n\t\t\tmin: -0.5,\n\t\t\tmax: ratingTypes.length-1,\n\t\t\tstartOnTick: false,\n\t\t\tshowFirstLabel: false,\n\t\t\ttitle: {\n\t\t\t\tenabled: false\n\t\t\t},\n\t\t\tlabels: {\n\t\t\t\tstyle: {\n\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\tcolor: msciDark\n\t\t\t\t}\n\t\t\t},\n\t\t\tcategories: ratingTypes,\n\t\t\ttickmarkPlacement: "on",\n\t\t\tgridLineWidth: 0,\n\t\t\tgridLineColor: msciDark,\n\t\t\tlineWidth: 1,\n\t\t\tlineColor: msciDark\n\t\t},\n\t\txAxis: {\n\t\t\tcategories: chartData.esgRatingHistory.dates,\n\t\t\tlabels: {\n\t\t\t\tautoRotation: [-45],\n\t\t\t\tstyle: {\n\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\tcolor: msciDark\n\t\t\t\t}\n\t\t\t},\n\t\t\ttickWidth: 0,\n\t\t\tlineWidth: 1,\n\t\t\tlineColor: msciDark\n\t\t},\n\t\tplotOptions: {\n\t\t\tline: {\n\t\t\t\tmarker: {\n\t\t\t\t\tsymbol: \'circle\',\n\t\t\t\t\tradius: 20\n\t\t\t\t},\n\t\t\t\tdataLabels : {\n\t\t\t\t\tenabled : true,\n\t\t\t\t\tformatter : function() {\n\t\t\t\t\t\treturn this.key;\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\t\ttextOutline: undefined,\n\t\t\t\t\t\tcolor: msciWhite\n\t\t\t\t\t},\n\t\t\t\t\tverticalAlign: \'middle\'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ttooltip: {\n\t\t\tformatter: function () {\n\t\t\t\treturn \'<b>\' + this.x + \': \' + this.key + \'</b>\';\n\t\t\t}\n\t\t}\n\t}, function(chart) {\n\n        var newRadius = Math.min(chart.plotBox.width / chart.axes[0].categories.length / 2.5, 20);\n        var newFontSize = msciFontSizeMedium;\n        if(newRadius < 10) newFontSize = msciFontSizeSmallest;\n        else if(newRadius < 12) newFontSize = msciFontSizeSmaller;\n        else if(newRadius < 14) newFontSize = msciFontSizeSmall;\n        \n\t    chart.series[0].update({\n            marker: {\n                radius: newRadius\n            },\n\t\t\tdataLabels : {\n\t\t\t\tstyle: {\n\t\t\t\t\tfontSize: newFontSize\n\t\t\t\t}\n\t\t\t}\n\t    });\n    });\n\t\t\n\t\n\tvar maxValue = 0;\n\t \n\t\tvar selected = false\n\t\tvar rating = \'CCC\';\n\t\tvar color = "";\n\t\tvar fontColor = "";\n\t\tvar value = 1;\n\t\tif(value > maxValue) maxValue = value;\n\t\t\n\t\tif(selected){\n\t\t\tcolor = ratingTypesValueAndColorMapping[rating].color;\n\t\t\tfontColor = color;\n\t\t}\n\t\telse {\n\t\t\tcolor = new Highcharts.Color(ratingTypesValueAndColorMapping[rating].color).setOpacity(opacity).get(\'rgba\');\n\t\t\tfontColor = msciDark;\n\t\t}\n\t\t\n\t\tvar map = {\n\t\t\t\ty: value,\n\t\t\t\tx: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: color,\n\t\t\t\tselected: selected,\n\t\t\t\tdataLabels: {\n\t\t\t\t\tformatter : function() {\n\t\t\t\t\t\tif(this.point.selected) return \'<b>\' + this.y + \'% </b>\';\n\t\t\t\t\t\telse return \'<span style="opacity: \' + opacity + \';">\' + this.y + \'% </span>\';\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\t\tfontFamily: robotoRegular,\n\t\t\t\t\t\ttextOutline: undefined,\n\t\t\t\t\t\tfontWeight: "regular",\n\t\t\t\t\t\tcolor: fontColor\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tchartData.esgRatingDistribution.distribution.push(map);\n\t\t \n\t\tvar selected = false\n\t\tvar rating = \'B\';\n\t\tvar color = "";\n\t\tvar fontColor = "";\n\t\tvar value = 8;\n\t\tif(value > maxValue) maxValue = value;\n\t\t\n\t\tif(selected){\n\t\t\tcolor = ratingTypesValueAndColorMapping[rating].color;\n\t\t\tfontColor = color;\n\t\t}\n\t\telse {\n\t\t\tcolor = new Highcharts.Color(ratingTypesValueAndColorMapping[rating].color).setOpacity(opacity).get(\'rgba\');\n\t\t\tfontColor = msciDark;\n\t\t}\n\t\t\n\t\tvar map = {\n\t\t\t\ty: value,\n\t\t\t\tx: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: color,\n\t\t\t\tselected: selected,\n\t\t\t\tdataLabels: {\n\t\t\t\t\tformatter : function() {\n\t\t\t\t\t\tif(this.point.selected) return \'<b>\' + this.y + \'% </b>\';\n\t\t\t\t\t\telse return \'<span style="opacity: \' + opacity + \';">\' + this.y + \'% </span>\';\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\t\tfontFamily: robotoRegular,\n\t\t\t\t\t\ttextOutline: undefined,\n\t\t\t\t\t\tfontWeight: "regular",\n\t\t\t\t\t\tcolor: fontColor\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tchartData.esgRatingDistribution.distribution.push(map);\n\t\t \n\t\tvar selected = false\n\t\tvar rating = \'BB\';\n\t\tvar color = "";\n\t\tvar fontColor = "";\n\t\tvar value = 23;\n\t\tif(value > maxValue) maxValue = value;\n\t\t\n\t\tif(selected){\n\t\t\tcolor = ratingTypesValueAndColorMapping[rating].color;\n\t\t\tfontColor = color;\n\t\t}\n\t\telse {\n\t\t\tcolor = new Highcharts.Color(ratingTypesValueAndColorMapping[rating].color).setOpacity(opacity).get(\'rgba\');\n\t\t\tfontColor = msciDark;\n\t\t}\n\t\t\n\t\tvar map = {\n\t\t\t\ty: value,\n\t\t\t\tx: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: color,\n\t\t\t\tselected: selected,\n\t\t\t\tdataLabels: {\n\t\t\t\t\tformatter : function() {\n\t\t\t\t\t\tif(this.point.selected) return \'<b>\' + this.y + \'% </b>\';\n\t\t\t\t\t\telse return \'<span style="opacity: \' + opacity + \';">\' + this.y + \'% </span>\';\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\t\tfontFamily: robotoRegular,\n\t\t\t\t\t\ttextOutline: undefined,\n\t\t\t\t\t\tfontWeight: "regular",\n\t\t\t\t\t\tcolor: fontColor\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tchartData.esgRatingDistribution.distribution.push(map);\n\t\t \n\t\tvar selected = false\n\t\tvar rating = \'BBB\';\n\t\tvar color = "";\n\t\tvar fontColor = "";\n\t\tvar value = 25;\n\t\tif(value > maxValue) maxValue = value;\n\t\t\n\t\tif(selected){\n\t\t\tcolor = ratingTypesValueAndColorMapping[rating].color;\n\t\t\tfontColor = color;\n\t\t}\n\t\telse {\n\t\t\tcolor = new Highcharts.Color(ratingTypesValueAndColorMapping[rating].color).setOpacity(opacity).get(\'rgba\');\n\t\t\tfontColor = msciDark;\n\t\t}\n\t\t\n\t\tvar map = {\n\t\t\t\ty: value,\n\t\t\t\tx: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: color,\n\t\t\t\tselected: selected,\n\t\t\t\tdataLabels: {\n\t\t\t\t\tformatter : function() {\n\t\t\t\t\t\tif(this.point.selected) return \'<b>\' + this.y + \'% </b>\';\n\t\t\t\t\t\telse return \'<span style="opacity: \' + opacity + \';">\' + this.y + \'% </span>\';\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\t\tfontFamily: robotoRegular,\n\t\t\t\t\t\ttextOutline: undefined,\n\t\t\t\t\t\tfontWeight: "regular",\n\t\t\t\t\t\tcolor: fontColor\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tchartData.esgRatingDistribution.distribution.push(map);\n\t\t \n\t\tvar selected = true\n\t\tvar rating = \'A\';\n\t\tvar color = "";\n\t\tvar fontColor = "";\n\t\tvar value = 30;\n\t\tif(value > maxValue) maxValue = value;\n\t\t\n\t\tif(selected){\n\t\t\tcolor = ratingTypesValueAndColorMapping[rating].color;\n\t\t\tfontColor = color;\n\t\t}\n\t\telse {\n\t\t\tcolor = new Highcharts.Color(ratingTypesValueAndColorMapping[rating].color).setOpacity(opacity).get(\'rgba\');\n\t\t\tfontColor = msciDark;\n\t\t}\n\t\t\n\t\tvar map = {\n\t\t\t\ty: value,\n\t\t\t\tx: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: color,\n\t\t\t\tselected: selected,\n\t\t\t\tdataLabels: {\n\t\t\t\t\tformatter : function() {\n\t\t\t\t\t\tif(this.point.selected) return \'<b>\' + this.y + \'% </b>\';\n\t\t\t\t\t\telse return \'<span style="opacity: \' + opacity + \';">\' + this.y + \'% </span>\';\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\t\tfontFamily: robotoRegular,\n\t\t\t\t\t\ttextOutline: undefined,\n\t\t\t\t\t\tfontWeight: "regular",\n\t\t\t\t\t\tcolor: fontColor\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tchartData.esgRatingDistribution.distribution.push(map);\n\t\t \n\t\tvar selected = false\n\t\tvar rating = \'AA\';\n\t\tvar color = "";\n\t\tvar fontColor = "";\n\t\tvar value = 13;\n\t\tif(value > maxValue) maxValue = value;\n\t\t\n\t\tif(selected){\n\t\t\tcolor = ratingTypesValueAndColorMapping[rating].color;\n\t\t\tfontColor = color;\n\t\t}\n\t\telse {\n\t\t\tcolor = new Highcharts.Color(ratingTypesValueAndColorMapping[rating].color).setOpacity(opacity).get(\'rgba\');\n\t\t\tfontColor = msciDark;\n\t\t}\n\t\t\n\t\tvar map = {\n\t\t\t\ty: value,\n\t\t\t\tx: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: color,\n\t\t\t\tselected: selected,\n\t\t\t\tdataLabels: {\n\t\t\t\t\tformatter : function() {\n\t\t\t\t\t\tif(this.point.selected) return \'<b>\' + this.y + \'% </b>\';\n\t\t\t\t\t\telse return \'<span style="opacity: \' + opacity + \';">\' + this.y + \'% </span>\';\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\t\tfontFamily: robotoRegular,\n\t\t\t\t\t\ttextOutline: undefined,\n\t\t\t\t\t\tfontWeight: "regular",\n\t\t\t\t\t\tcolor: fontColor\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tchartData.esgRatingDistribution.distribution.push(map);\n\t\t \n\t\tvar selected = false\n\t\tvar rating = \'AAA\';\n\t\tvar color = "";\n\t\tvar fontColor = "";\n\t\tvar value = 1;\n\t\tif(value > maxValue) maxValue = value;\n\t\t\n\t\tif(selected){\n\t\t\tcolor = ratingTypesValueAndColorMapping[rating].color;\n\t\t\tfontColor = color;\n\t\t}\n\t\telse {\n\t\t\tcolor = new Highcharts.Color(ratingTypesValueAndColorMapping[rating].color).setOpacity(opacity).get(\'rgba\');\n\t\t\tfontColor = msciDark;\n\t\t}\n\t\t\n\t\tvar map = {\n\t\t\t\ty: value,\n\t\t\t\tx: ratingTypesValueAndColorMapping[rating].value,\n\t\t\t\tname: rating, \n\t\t\t\tcolor: color,\n\t\t\t\tselected: selected,\n\t\t\t\tdataLabels: {\n\t\t\t\t\tformatter : function() {\n\t\t\t\t\t\tif(this.point.selected) return \'<b>\' + this.y + \'% </b>\';\n\t\t\t\t\t\telse return \'<span style="opacity: \' + opacity + \';">\' + this.y + \'% </span>\';\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: msciFontSizeMedium,\n\t\t\t\t\t\tfontFamily: robotoRegular,\n\t\t\t\t\t\ttextOutline: undefined,\n\t\t\t\t\t\tfontWeight: "regular",\n\t\t\t\t\t\tcolor: fontColor\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tchartData.esgRatingDistribution.distribution.push(map);\n\t\t \n\n\tvar width = window.innerWidth;\n\tvar bigCategoryFontSize;\n\tvar smallCategoryFontSize;\n    if(width < tablet){\n    \tbigCategoryFontSize = msciFontSizeSmall;\n    \tsmallCategoryFontSize = msciFontSizeSmaller;\n    }\n    else if(width < desktop){\n    \tbigCategoryFontSize = msciFontSizeMedium;\n    \tsmallCategoryFontSize = msciFontSizeSmall;\n    }\n    else{\n    \tbigCategoryFontSize = msciFontSizeLarge;\n    \tsmallCategoryFontSize = msciFontSizeMedium;\n    }\n\t\n\tvar esgRatingDistributionChart = Highcharts.chart(\'_esgratingsprofile_esg-rating-distribution\', {\n\t\tlegend: false,\n\t\tcredits: false,\n\t\ttitle: undefined,\n\t\tseries: [\n\t\t\t{\n\t\t\t\txAxis: 0,\n\t\t\t\tdata: chartData.esgRatingDistribution.distribution,\n\t\t\t\tborderColor: "transparent"\n\t\t\t},\n\t\t\t{\n\t\t\t\txAxis: 1,\n\t\t\t\ttype: \'scatter\'\n\t\t\t}\n\t\t],\n\t\tchart: {\n\t\t\ttype: "column",\n\t\t\theight: 277,\n\t\t\tstyle: {\n\t\t\t\t"fontFamily": robotoRegular,\n\t\t\t\t"fontSize": msciFontSizeSmall,\n\t\t\t\t"color": msciDark\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\trender: function () {\n\t\t\t\t\tif(this.selectedColumnMarker) {\n\t\t\t\t\t\tthis.selectedColumnMarker.destroy();\n\t\t\t\t\t}\n\t\t\t\t    var column = this.series[0].data[ratingTypesValueAndColorMapping["A"].value]\n\t\t\t\t\tvar rectangle = this.renderer.rect(column.shapeArgs.x, column.shapeArgs.y - 15, column.shapeArgs.width + 20, column.shapeArgs.height + 55).attr({\n\t\t\t            stroke: msciDark,\n\t\t\t            \'stroke-width\': 1,\n\t\t\t            zIndex: 4\n\t\t\t        }).add();\n\t\t\t\t    \n\t\t\t\t    this.selectedColumnMarker = rectangle;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tyAxis: {\n\t\t\tmin: 0,\n\t\t\tmax: maxValue * 1.15,\n\t\t\ttitle: {\n\t\t\t\tenabled: false\n\t\t\t},\n\t\t\tlabels: {\n\t\t\t\tenabled: false,\n\t\t\t\tstyle: {\n\t\t\t\t\tfontSize: smallCategoryFontSize,\n\t\t\t\t\tcolor: msciDark\n\t\t\t\t}\n\t\t\t},\n\t\t\tgridLineWidth: 0\n\t\t},\n\t\txAxis: [\n\t\t\t{\n\t\t\t\tcategories: ratingTypes,\n\t\t\t\ttickWidth: 0,\n\t\t\t\tlineColor: msciDark,\n\t\t\t\tlabels: {\n\t\t\t\t\tautoRotation: false,\n\t\t\t\t\tformatter: function() {\n\t\t\t\t\t\tif(this.value === "A") return this.value;\n\t\t\t\t\t\telse return \'<span style="opacity: \' + opacity + \';">\' + this.value + \'</span>\';\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: smallCategoryFontSize,\n\t\t\t\t\t\tcolor: msciDark\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\toffset: 25,\n\t\t\t\ttickWidth: 0,\n\t\t\t\tlineWidth: 0,\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 100,\n\t\t\t\ttickPositions: [14, 50, 86],\n\t\t\t\tlabels: {\n\t\t\t\t\tformatter: function() {\n\t\t\t\t\t\tvar color = null;\n\t\t\t\t\t\tvar groupName = null;\n\t\t\t\t\t\tvar selected = false;\n\t\t\t\t\t\tif(this.value == 14){\n\t\t\t\t\t\t\tcolor = "#CF333B";\n\t\t\t\t\t\t\tgroupName = "LAGGARD";\n\t\t\t\t\t\t\tif(false) selected = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(this.value == 50){\n\t\t\t\t\t\t\tcolor = "#FFB500";\n\t\t\t\t\t\t\tgroupName = "AVERAGE";\n\t\t\t\t\t\t\tif(true) selected = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tcolor = "#007567";\n\t\t\t\t\t\t\tgroupName = "LEADER";\n\t\t\t\t\t\t\tif(false) selected = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(selected) return \'<span style="fill:\' + color + \';">\' + groupName + \'</span>\';\n\t\t\t\t\t\telse return \'<span style="opacity: \' + opacity + \'; fill:\' + color + \';">\' + groupName + \'</span>\';\n\t\t\t\t\t}, \n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize: bigCategoryFontSize,\n\t\t\t\t\t\tfontWeight: "bold",\n\t\t\t\t\t\tfontFamily: robotoBlack\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t],\n\t\tplotOptions: {\n\t\t\tcolumn: {\n\t\t\t\tdataLabels : {\n\t\t\t\t\tenabled : true\n\t\t\t\t},\n\t\t\t\tstates: {\n\t\t\t\t\tselect: {\n\t\t\t\t\t\tcolor: undefined,\n\t\t\t\t\t\tborderColor: "transparent"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ttooltip: {\n\t\t\tformatter: function () {\n\t\t\t\treturn \'<b>\' + this.x + \': \' + this.y + \'%</b>\';\n\t\t\t}\n\t\t}\n\t});\n\t\n\tHighcharts.addEvent(window, \'resize\', function(e) {\n        var newRadius = Math.min((esgRatingHistoryChart.containerWidth-60) / esgRatingHistoryChart.axes[0].categories.length / 2.5, 20);\n        var newFontSize = msciFontSizeMedium;\n        if(newRadius < 10) newFontSize = msciFontSizeSmallest;\n        else if(newRadius < 12) newFontSize = msciFontSizeSmaller;\n        else if(newRadius < 14) newFontSize = msciFontSizeSmall;\n        \n        esgRatingHistoryChart.series[0].update({\n            marker: {\n                radius: newRadius\n            },\n\t\t\tdataLabels : {\n\t\t\t\tstyle: {\n\t\t\t\t\tfontSize: newFontSize\n\t\t\t\t}\n\t\t\t}\n\t    });\n        \n        var width = window.innerWidth;\n        \n        if(width < tablet) newFontSize = msciFontSizeSmall;\n        else if(width < desktop) newFontSize = msciFontSizeMedium;\n        else newFontSize = msciFontSizeLarge;\n        \n        esgRatingDistributionChart.axes[1].update({\n        \tlabels: {\n        \t\tstyle: {\n        \t\t\tfontSize: newFontSize\n        \t\t}\n        \t}\n        }, false)\n        \n        if(width < tablet) newFontSize = msciFontSizeSmall;\n        else newFontSize = msciFontSizeMedium;\n        \n        esgRatingDistributionChart.axes[0].update({\n        \tlabels: {\n        \t\tstyle: {\n        \t\t\tfontSize: newFontSize\n        \t\t}\n        \t}\n        })\n    });\n\t\n});\n</script>\n\n\t\t\n<div id="_esgratingsprofile_esg-ratings-profile-industry-comparison" class="esg-ratings-profile-industry-comparison">\n\t<div class="esg-rating-paragraph">\n\t\tWe focus on the key issues material to the <b>banks industry</b>. Here is how <b>Industrial Bank</b> compares to industry peers. MSCI also evaluates companies on their controversial business activities (weapons, tobacco, gambling, global norms and principles etc)  and sustainable impact solutions (renewable energy, health, education etc). This information is only factored into the MSCI ESG Ratings from a financial risk perspective. For more details, visit the <a href="https://www.msci.com/esg-investing">ESG investing page.</a>\n\t</div>\n\t<div class="comparison-table row no-gutters">\t\n\t\t\n\t\t\t<div class="comparison-column col-lg-4">\n\t\t\t\t<div class="comparison-header comparison-header-laggard">\n\t\t\t\t\tESG LAGGARD\n\t\t\t\t\t<div class="esg-tooltip">ESG LAGGARD: lagging the industry in its management of these ESG risks</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="comparison-body row no-gutters justify-content-center">\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div class="comparison-value col-xs-6">\n\t\t\t\t\t\t\t\t\t\t<div class=\'esg-rating-icon-esr-fin-sys\' />\n\t\t\t\t\t\t\t\t\t\t<span>Financial System Instability</span>\n\t\t\t\t\t\t\t\t\t\t<div class="esg-tooltip">This issue evaluates a company\xe2\x80\x99s risk oversight, governance, and commitments to ethical standards and the extent to which they may face enhanced regulatory scrutiny because of their contributions to systemic risk in financial markets</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class="comparison-column col-lg-4">\n\t\t\t\t<div class="comparison-header comparison-header-average">\n\t\t\t\t\tAVERAGE\n\t\t\t\t\t<div class="esg-tooltip">AVERAGE: mixed or unexceptional track record of managing these ESG risks relative to peers</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="comparison-body row no-gutters justify-content-center">\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div class="comparison-value col-xs-6">\n\t\t\t\t\t\t\t\t\t\t<div class=\'esg-rating-icon-esr-gov\' />\n\t\t\t\t\t\t\t\t\t\t<span>Corporate Governance</span>\n\t\t\t\t\t\t\t\t\t\t<div class="esg-tooltip">This theme evaluates the extent to which companies\xe2\x80\x99 corporate governance practices may pose risks to investors</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div class="comparison-value col-xs-6">\n\t\t\t\t\t\t\t\t\t\t<div class=\'esg-rating-icon-esr-safe-fin\' />\n\t\t\t\t\t\t\t\t\t\t<span>Financial Product Safety</span>\n\t\t\t\t\t\t\t\t\t\t<div class="esg-tooltip">This issue evaluates the potential for unanticipated credit losses, litigation, or regulatory change related to financial products that lack transparency or are unsafe to the end-user</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div class="comparison-value col-xs-6">\n\t\t\t\t\t\t\t\t\t\t<div class=\'esg-rating-icon-esr-hum-cap\' />\n\t\t\t\t\t\t\t\t\t\t<span>Human Capital Development</span>\n\t\t\t\t\t\t\t\t\t\t<div class="esg-tooltip">This issue evaluates companies\xe2\x80\x99 capacity to attract, retain and develop their human capital</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div class="comparison-value col-xs-6">\n\t\t\t\t\t\t\t\t\t\t<div class=\'esg-rating-icon-esr-priv-sec\' />\n\t\t\t\t\t\t\t\t\t\t<span>Privacy & Data Security</span>\n\t\t\t\t\t\t\t\t\t\t<div class="esg-tooltip">This issue evaluates the potential for regulatory risks, cost increases or reputational damage from a data breach or controversial use of personal data</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class="comparison-column col-lg-4">\n\t\t\t\t<div class="comparison-header comparison-header-leader">\n\t\t\t\t\tESG LEADER\n\t\t\t\t\t<div class="esg-tooltip">ESG LEADER: leading the industry in its management of these ESG risks</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="comparison-body row no-gutters justify-content-center">\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div class="comparison-value col-xs-6">\n\t\t\t\t\t\t\t\t\t\t<div class=\'esg-rating-icon-esr-acc-fin\' />\n\t\t\t\t\t\t\t\t\t\t<span>Access to Finance</span>\n\t\t\t\t\t\t\t\t\t\t<div class="esg-tooltip">This issue evaluates companies\xe2\x80\x99 efforts to take advantage of opportunities for growth in finance products and services in developing countries and underserved markets (e.g. rural, small business)</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div class="comparison-value col-xs-6">\n\t\t\t\t\t\t\t\t\t\t<div class=\'esg-rating-icon-esr-env-fin\' />\n\t\t\t\t\t\t\t\t\t\t<span>Financing Environmental Impact</span>\n\t\t\t\t\t\t\t\t\t\t<div class="esg-tooltip">This issue evaluates potential credit or reputational risks companies may face from indirect exposure to the environmental concerns facing borrowers</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t</div>\n\t\n</div>\n\n\t</div>\n'
    # '''
    # 选择lxml作为解析器
    soup = BeautifulSoup(html.content, 'lxml')
    # print(soup.prettify())#自动更正格式，使输出更美观
    data_list = []
    count_msci = count_msci + 1
    print('<%d><%s>origin content:%s' %(count_msci,msci_id,html.content))
    str_content = str(html.content, encoding="utf-8")
    if str_content == '':
        continue
    tmp = []
    company_name= soup.find(class_ = 'header-company-title').text
    tmp.append(company_name)
    company_ticker = soup.find(class_='header-company-ticker').text
    tmp.append(company_ticker)
    header_country = soup.find(class_='header-country').text
    tmp.append(header_country)
    header_industry = soup.find(class_='header-esg-industry').text
    tmp.append(header_industry)
    regex = re.compile("esg-rating-circle-[a-c]+")
    rate = regex.findall(str_content)
    tmp.append(rate[0])
    rating_history = soup.find(class_='esg-rating-paragraph esg-rating-paragraph-hist col-lg-6').text
    tmp.append(rating_history)
    level=soup.find(class_='esg-rating-paragraph esg-rating-paragraph-distr col-lg-6').text
    tmp.append(level)

    abc=soup.find_all('div',class_='comparison-body row no-gutters justify-content-center')
    for tag in abc:
        divs = tag.find_all('div', class_='comparison-value col-xs-6')
        span_string = ''
        for div in divs:
            spans = div.find_all('span')
            for span in spans:
                span_string = span_string + '-' + span.text
        tmp.append(span_string)

    print('<%d> %s' %(count_msci, tmp))
    msci2excel.append(tmp)

print(msci2excel)
wb=Workbook()
# 设置Excel文件名
dest_filename = 'companyinfo.xlsx'
# 新建一个表
ws1 = wb.active
setData = []
setData.append(msci2excel)
# 设置表头
titleList = ['company title', 'company ticker', 'country', 'industry','rate',
             'rating_history','level','ESG LAGGARD','AVERAGE','ESG LEADER']
for row in range(len(titleList)):
    c = row + 1
    ws1.cell(row=1, column=c, value=titleList[row])

# 填写表内容
for listIndex in range(len(setData)):
    ws1.append(setData[listIndex])

wb.save(filename=dest_filename)



